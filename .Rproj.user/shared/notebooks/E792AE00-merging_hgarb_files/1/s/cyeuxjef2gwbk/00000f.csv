"0","read_1_file <- function (filename) {"
"0","    filename = paste0(""data/HGarb_Updates_2022/"", filename)"
"0",""
"0","### sheet 1"
"0","s1 = import(filename, sheet = ""GASB 68"", skip = 1) %>% clean_names() %>% "
"0","    filter(!is.na(fye)) %>% slice(1:9) %>% "
"0","  # Differentiate some cols from sheet 1 & sheet 3 "
"0","  setnames("
"0","    old = c(""adec_amt"", ""adec_paid_amt"", ""adec_missed""),"
"0","    new = c(paste0(c(""adec_amt"", ""adec_paid_amt"", ""adec_missed""), ""_from_gasb"")))"
"0",""
"0","### sheet 2"
"0","s2 = import(filename, sheet = ""Actuarial Valuation"", skip = 1) %>% #""Actuarial Valuation"""
"0","      clean_names() %>% "
"0","    filter(!is.na(fye)) %>% slice(1:22) %>% "
"0","      mutate(fye = as.double(fye)) %>%  # solve a few cases in sheet 2 "
"0","  "
"0","      # Differentiate some cols from sheet 2 & sheet 3 "
"0","      setnames("
"0","        old =  c(""actuarial_return"", ""market_return"",""ava"" , ""aal"",""ual"", ""funded_ratio_old"", ""payroll""), "
"0","        new = c(paste0(c(""actuarial_return"", ""market_return"",""ava"" , ""aal"", ""ual"", ""funded_ratio_old"", ""payroll""), ""_from_valuation"")))"
"0",""
"0",""
"0","###sheet 3"
"0","s3 = import(filename, sheet = ""CAFR"", skip = 1) %>% #""CAFR"""
"0","       clean_names() %>% "
"0","    filter(!is.na(fye)) %>% slice(1:22) %>% "
"0","    # Differentiate some cols from sheet 2 & sheet 3 "
"0","   setnames(old = c(""actuarial_return"", ""market_return"", ""ava"", ""aal"", ""ual"", ""funded_ratio_old"","
"0","""payroll""),"
"0","    new = c(paste0(c(""actuarial_return"", ""market_return"", ""ava"", ""aal"", ""ual"", ""funded_ratio_old"","
"0","""payroll""), ""_from_acfr""))) %>% "
"0","  "
"0","  # Differentiate sheet 1 & sheet 3"
"0","  setnames("
"0","    old = c(""adec_amt"", ""adec_paid_amt"", ""adec_missed""),"
"0","    new = c(paste0(c(""adec_amt"", ""adec_paid_amt"", ""adec_missed""), ""_from_acfr"")))"
"0","  "
"0",""
"0"," result <- s1 %>% "
"0","      full_join(s2, by = c(""full_name"", ""fye"")) %>% "
"0","      full_join(s3, by = c(""full_name"", ""fye"")) %>% "
"0","      arrange(fye)"
"0"," return(result)"
"0","}"
